{%  extends "openassessmentblock/oa_response.html" %}

{% block list_item %}
<li id="openassessment__response" class="openassessment__steps__step step--response is--graded is--collapsed ui-toggle-visibility">
{% endblock %}

{% block body %}
<div class="step__content">
<!-- user's response -->
<article class="submission__answer__display">
    <h3 class="submission__answer__display__title">Your Submitted Response</h3>

    <div class="submission__answer__display__content">
        {{ student_submission.answer }}
    </div>
</article>

<!-- peer evaluations -->
<article class="submission__peer-evaluations">
<h3 class="submission__peer-evaluations__title">Peer Evaluations Of Your Response</h3>

<ol class="list submission__peer-evaluations__questions">
{% for criterion in rubric_criteria %}
{% with criterion_num=forloop.counter %}
<!-- individual question from rubric -->
<li class="question question--{{ criterion_num }} ui-toggle-visibility">
    <h4 class="question__title ui-toggle-visibility__control">
        <span class="title__copy">{{ criterion.name }}</span>
            <span class="question__score">
              <span class="label sr">Overall Question Score</span>
              <span class="question__score__value">{{ criterion.median_score }}</span>
              <span class="label label--divider sr">out of</span>
              <span class="question__score__potential">{{ criterion.total_value }}</span>
            </span>
    </h4>
    {% for assessment in peer_assessments %}
    {% with peer_num=forloop.counter %}
    {% for part in assessment.parts %}
    {% if part.option.criterion.name == criterion.name %}
    <ul class="question__answers ui-toggle-visibility__content">
        <li class="answer peer-assessment--{{ peer_num}}"
            id="question--{{ criterion_num }}__answer-{{ peer_num }}">
            <h5 class="answer__title">
                <span class="answer__source">
                  <span class="label sr">Assessor: </span>
                  <span class="value">Peer {{ peer_num }}</span>
                </span>
                <span class="answer__value">
                  <span class="label sr">Peer's Assessment: </span>
                  <span class="value">{{ part.option.name }}</span>
                </span>
            </h5>

              <span class="answer__content">
                {{ part.option.explanation }}
              </span>
        </li>
    </ul>
    {% endif %}
    {% endfor %}
    {% endwith %}
    {% endfor %}
</li>
{% endwith %}
{% endfor %}
</ol>
</article>

<!-- peer assessment feedback -->
<form id="submission__feeedback" class="submission__feeedback ui-toggle-visibility" method="post">
    <h3 class="submission__feeedback__title ui-toggle-visibility__control">Give Feedback On Peer Evaluations</h3>

    <ol class="list list--fields submission__feeedback__content ui-toggle-visibility__content">
        <li class="field field--textarea feedback__remarks" id="feedback__remarks">
            <label for="feedback__remarks__value">Please provide any thoughts or comments on the feedback you received from your peers here. Donec sed odio dui. Vivamus sagittis lacus vel augue laoreet rutrum faucibus dolor auctor.</label>
            <textarea id="feedback__remarks__value" placeholder="I feel the feedback I received was..."></textarea>
        </li>
    </ol>

    <ul class="list list--actions">
        <li class="list--actions__item">
            <button type="submit" id="feedback__submit" class="action action--submit feedback__submit">Submit Feedback On Peer Evaluations</button>
        </li>
    </ul>
</form>
</div>
{% endblock %}
